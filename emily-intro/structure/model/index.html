<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="https://amboltio.github.io/emily-intro/">
    <meta name="generator" content="Hugo 0.68.3" />
    <meta name="description" content="">


    <link rel="icon" href="/emily-intro/images/favicon.png" type="image/png">

    <title>Model :: Emily</title>

    
    <link href="/emily-intro/css/nucleus.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/fontawesome-all.min.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/hybrid.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/featherlight.min.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/perfect-scrollbar.min.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/auto-complete.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/atom-one-dark-reasonable.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/theme.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/tabs.css?1635154563" rel="stylesheet">
    <link href="/emily-intro/css/hugo-theme.css?1635154563" rel="stylesheet">
    
    

    <script src="/emily-intro/js/jquery-3.3.1.min.js?1635154563"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/emily-intro/emily-intro/structure/model/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='https://dmiai.dk/en/'>
<img src="/emily-intro/images/logo.svg">
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/emily-intro/js/lunr.min.js?1635154563"></script>
<script type="text/javascript" src="/emily-intro/js/auto-complete.js?1635154563"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/amboltio.github.io\/emily-intro\/";
    
</script>
<script type="text/javascript" src="/emily-intro/js/search.js?1635154563"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/emily-intro/emily-intro/" title="Getting started with Emily" class="dd-item
        parent
        
        
        ">
      <a href="/emily-intro/emily-intro/">
          <b>1. </b>Getting started with Emily
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/install/" title="Install Emily" class="dd-item ">
        <a href="/emily-intro/emily-intro/install/">
        Install Emily
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/build/" title="Create Emily project" class="dd-item ">
        <a href="/emily-intro/emily-intro/build/">
        Create Emily project
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/emily-intro/emily-intro/structure/" title="Template structure" class="dd-item
        parent
        
        
        ">
      <a href="/emily-intro/emily-intro/structure/">
          Template structure
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/api/" title="API" class="dd-item ">
        <a href="/emily-intro/emily-intro/structure/api/">
        API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/emily/" title="Emily" class="dd-item ">
        <a href="/emily-intro/emily-intro/structure/emily/">
        Emily
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/model/" title="Model" class="dd-item active">
        <a href="/emily-intro/emily-intro/structure/model/">
        Model
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/trainer/" title="Trainer" class="dd-item ">
        <a href="/emily-intro/emily-intro/structure/trainer/">
        Trainer
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/evaluator/" title="Evaluator" class="dd-item ">
        <a href="/emily-intro/emily-intro/structure/evaluator/">
        Evaluator
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/structure/predictor/" title="Predictor" class="dd-item ">
        <a href="/emily-intro/emily-intro/structure/predictor/">
        Predictor
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/emily-intro/share/" title="Share Emily projects" class="dd-item ">
        <a href="/emily-intro/emily-intro/share/">
        Share Emily projects
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/emily-intro/deploy/" title="Deploying a service" class="dd-item
        
        
        
        ">
      <a href="/emily-intro/deploy/">
          <b>2. </b>Deploying a service
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/emily-intro/deploy/structure/" title="Converting a notebook to API" class="dd-item
        
        
        
        ">
      <a href="/emily-intro/deploy/structure/">
          Converting a notebook to API
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/structure/api/" title="API" class="dd-item ">
        <a href="/emily-intro/deploy/structure/api/">
        API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/structure/model/" title="Model" class="dd-item ">
        <a href="/emily-intro/deploy/structure/model/">
        Model
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/structure/train/" title="Training" class="dd-item ">
        <a href="/emily-intro/deploy/structure/train/">
        Training
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/structure/eval/" title="Evaluating" class="dd-item ">
        <a href="/emily-intro/deploy/structure/eval/">
        Evaluating
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/structure/predict/" title="Predicting" class="dd-item ">
        <a href="/emily-intro/deploy/structure/predict/">
        Predicting
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/test/" title="API test" class="dd-item ">
        <a href="/emily-intro/deploy/test/">
        API test
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/emily-intro/deploy/deploy/" title="Deploy" class="dd-item ">
        <a href="/emily-intro/deploy/deploy/">
        Deploy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/emily-intro/'></a> > <a href='/emily-intro/emily-intro/'>Getting started with Emily</a> > <a href='/emily-intro/emily-intro/structure/'>Template structure</a> > Model
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents"></nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Model
            </h1>
          

        


<p>The model is where the type of machine learning model to be used in the Emily project is specified. This should be done by letting the model class inherit from whichever machine learning model you wish to use in the project. For example, if you want to use a linear regression model, you can use the LinearRegression class from scikit-learn:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Model</span>(sklearn<span style="color:#f92672">.</span>linear_model<span style="color:#f92672">.</span>LinearRegression):
</code></pre></div><p>When we forward a sample to the model, it should make a prediction. This should be implemented in the <code>forward</code> method. For example, if you are using a scikit-learn model, this can be done in the following way:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, sample):
  <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>predict(sample)
</code></pre></div><p>Finally, we must implement saving and loading a model in the <code>save_model</code> and <code>load_model</code> methods. Both can for example be done using the pickle library. Saving a model using pickle can be done in the following way:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save_model</span>(self, save_path):
    <span style="color:#66d9ef">with</span> open(save_path, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> fp:
        pickle<span style="color:#f92672">.</span>dump(self, fp)
</code></pre></div><p>Likewise, loading a model using pickle can be done like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_model</span>(self, model_path):
    <span style="color:#66d9ef">with</span> open(model_path, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> fp:
        model <span style="color:#f92672">=</span> pickle<span style="color:#f92672">.</span>load(fp)
        self<span style="color:#f92672">.</span>__dict__<span style="color:#f92672">.</span>update(model<span style="color:#f92672">.</span>__dict__)
</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/emily-intro/emily-intro/structure/emily/" title="Emily"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/emily-intro/emily-intro/structure/trainer/" title="Trainer" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/emily-intro/js/clipboard.min.js?1635154563"></script>
    <script src="/emily-intro/js/perfect-scrollbar.min.js?1635154563"></script>
    <script src="/emily-intro/js/perfect-scrollbar.jquery.min.js?1635154563"></script>
    <script src="/emily-intro/js/jquery.sticky.js?1635154563"></script>
    <script src="/emily-intro/js/featherlight.min.js?1635154563"></script>
    <script src="/emily-intro/js/highlight.pack.js?1635154563"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/emily-intro/js/modernizr.custom-3.6.0.js?1635154563"></script>
    <script src="/emily-intro/js/learn.js?1635154563"></script>
    <script src="/emily-intro/js/hugo-learn.js?1635154563"></script>
    
        
            <script src="/emily-intro/mermaid/mermaid.js?1635154563"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

